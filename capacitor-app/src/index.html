<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apparel Collection Agent App</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="capacitor.js"></script>
</head>
<body>
    <div id="app">
        <div id="login-page" class="page active">
            <div class="login-container">
                <h1>Apparel Collection</h1>
                <h2>Agent Login</h2>
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    <button type="submit" class="btn">Login</button>
                </form>
                <div id="login-error" class="error-message" style="display: none;"></div>
            </div>
        </div>

        <div id="dashboard-page" class="page">
            <div class="header">
                <h1>Dashboard</h1>
                <p>Welcome, <span id="agent-name">Agent</span></p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="total-collected">SAR 0.00</h3>
                    <p>Total Collected</p>
                </div>
                <div class="stat-card">
                    <h3 id="total-target">SAR 0.00</h3>
                    <p>Target Amount</p>
                </div>
                <div class="stat-card">
                    <h3 id="completion-rate">0%</h3>
                    <p>Completion Rate</p>
                </div>
                <div class="stat-card">
                    <h3 id="remaining-stores">0</h3>
                    <p>Stores Remaining</p>
                </div>
            </div>

            <div class="content-section">
                <h2>Your Assigned Stores (<span id="current-date"></span>)</h2>
                <div id="assignments-list">
                    <!-- Assignments will be loaded here -->
                </div>
            </div>
        </div>

        <div id="store-page" class="page">
            <div class="header">
                <h1>Store Collection</h1>
                <button id="back-to-dashboard" class="btn btn-secondary">← Back</button>
            </div>
            
            <div id="store-info">
                <!-- Store info will be loaded here -->
            </div>
            
            <div class="content-section">
                <h2>Collection Details</h2>
                <form id="collection-form">
                    <div class="form-group">
                        <label for="amount-collected">Amount Collected (SAR)</label>
                        <input type="number" id="amount-collected" name="amount_collected" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="pending-amount">Pending Amount (SAR)</label>
                        <input type="number" id="pending-amount" name="pending_amount" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="comments">Comments</label>
                        <textarea id="comments" name="comments"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="receipt-images">Upload Receipts/Proof of Collection</label>
                        <input type="file" id="receipt-images" name="receipt_images[]" multiple accept="image/*">
                        <small>Upload receipt images (JPG, PNG, GIF)</small>
                    </div>

                    <button type="submit" class="btn">Save Collection</button>
                    <button type="button" id="print-receipt-btn" class="btn btn-secondary">Print Receipt</button>
                </form>
                
                <div id="receipt-preview" class="receipt-preview" style="display: none;">
                    <!-- Receipt preview will be shown here -->
                </div>
            </div>
        </div>

        <div id="bank-submission-page" class="page">
            <div class="header">
                <h1>Bank Submission</h1>
                <button id="back-to-dashboard-2" class="btn btn-secondary">← Back</button>
            </div>
            
            <div class="card">
                <h2>Submit to Bank</h2>
                <p style="margin-bottom: 20px; color: var(--text-secondary);">
                    Today's Total Collected: <strong id="today-total">SAR 0.00</strong>
                </p>

                <form id="bank-submission-form">
                    <input type="hidden" name="submit_to_bank" value="1">
                    
                    <div class="form-group">
                        <label for="bank-total-amount">Total Amount to Submit (SAR)</label>
                        <input type="number" id="bank-total-amount" name="total_amount" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="bank-receipt-image">Bank Deposit Receipt</label>
                        <input type="file" id="bank-receipt-image" name="receipt_image" accept="image/*" required>
                        <small>Upload the bank deposit slip/receipt (JPG, PNG)</small>
                    </div>

                    <button type="submit" class="btn">Submit to Bank</button>
                </form>
            </div>

            <div class="card">
                <h2>Submission History</h2>
                <div id="submission-history">
                    <!-- History will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-navigation">
            <a href="#" class="nav-item" data-page="dashboard">
                <span class="material-icons">home</span>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="bank-submission">
                <span class="material-icons">receipt_long</span>
                <span>Submissions</span>
            </a>
            <a href="#" class="nav-item" data-page="store">
                <span class="material-icons">storefront</span>
                <span>Store</span>
            </a>
        </div>
    </div>

    <script src="https://unpkg.com/@ionic/pwa-elements@3.2.2/dist/ionicpwaelements.js"></script>
    <script src="app.js"></script>
</body>
</html>