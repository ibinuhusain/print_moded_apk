        <div id="installBanner" class="hidden" style="margin-top: 20px; padding: 10px; background-color: #e3f2fd; border-radius: 5px; text-align: center;">
            <p>Install this app on your device for better experience!</p>
            <button id="installBtn" class="btn btn-install">Install App</button>
        </div>
    </div>

    <script src="cordova.js"></script>
    <script src="js/api_bridge.js"></script>
    <script>
        document.addEventListener('deviceready', onDeviceReady, false);

        let capturedImageURI = null;
        let isConnectedToPrinter = false;
        let selectedPrinterAddress = null;
        let deferredPrompt;

        // Listen for the beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            // Show the install button
            document.getElementById('installBanner').classList.remove('hidden');
        });

        function onDeviceReady() {
            console.log('Cordova is ready!');
            initializeApp();
            
            // Check if running as PWA
            if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
                updateDebugInfo('App is running in standalone mode (PWA)');
            } else {
                updateDebugInfo('App is running in browser. Install for better experience.');
            }
        }

        function initializeApp() {
            // Set up event listeners
            document.getElementById('captureBtn').addEventListener('click', captureReceipt);
            document.getElementById('connectPrinterBtn').addEventListener('click', connectToPrinter);
            document.getElementById('printBtn').addEventListener('click', printReceipt);
            document.getElementById('installBtn').addEventListener('click', promptInstall);

            showMessage('App is ready. Click "Capture Receipt" to start.', 'success');
        }

        function promptInstall() {
            if (deferredPrompt) {
                // Show the install prompt
                deferredPrompt.prompt();
                
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                        showMessage('App installation started!', 'success');
                    } else {
                        console.log('User dismissed the install prompt');
                        showMessage('Installation was canceled', 'warning');
                    }
                    
                    // Reset the deferred prompt
                    deferredPrompt = null;
                    document.getElementById('installBanner').classList.add('hidden');
                });
            }
        }
